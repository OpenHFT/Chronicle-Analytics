= Chronicle-Analytics
Per Minborg

:toc: macro
:toclevels: 4
:css-signature: demo
:toc-placement: macro
:toc-title:

image:https://maven-badges.herokuapp.com/maven-central/net.openhft/chronicle-analytics/badge.svg[Maven Central,link=https://maven-badges.herokuapp.com/maven-central/net.openhft/chronicle-analytics]

This library provides remote ingress to Google Analytics 4, allowing usage-statistics to be collected for Java applications. The statistics can subsequently be analysed using
a variety of tools available from Google and other providers.

toc::[]

== API Overview

Applications will create and use instances of `Analytics`. Analytic instances are created using a builder pattern that optionally allows various custom parameters to be set, after which a new instance is created by invoking a `build()` method:

[source, java]
----
        String measurementId = "G-TDAZG4CU3G";
        String apiSecret = "k2hL3x2dQaKq9F2gQ-PNhQ";
        Analytics.Builder builder = Analytics.builder("G-TDAZG4CU3G", "k2hL3x2dQaKq9F2gQ-PNhQ");

        // optionally configure the builder, see JavaDocs

        Analytics analytics = builder.build();
        analytics.sendEvent("started");
----

NOTE: The `measurementId` and `apiSecret` values can be obtained directly from your Google Analytics account.

== Example

The following example sets up an analytics instance with the *event parameter* `app_version = 1.4.2` and perhaps the *user properties*
`os_name = Linux`, `os_version = 4.18.0.147.2.1.2l8_1.x86_64` and `java_runtime_version = 1.8.0_272-b10` depending on the environment used:

[source, java]
----
public class AnalyticsExampleMain {

    public static void main(String[] args) {

        Analytics analytics = Analytics.builder("G-TDAZG4CU3G", "k2hL3x2dQaKq9F2gQ-PNhQ")
                .putEventParameter("app_version", "1.4.2")
                .putUserProperty("os_name", System.getProperty("os.name"))
                .putUserProperty("os_version", System.getProperty("os.version"))
                .putUserProperty("java_runtime_version", System.getProperty("java.runtime.version"))
                .build();

        analytics.sendEvent("started");

        // do some job

        analytics.sendEvent("completed");

    }
}
----

When applications like this are run, statistics will be gathered by Google Analytics 4 allowing detailed insight as to how, where and when the application is used.

== Google Analytics 4 example

Here is an example of how data could be rendered using Google Analytics 4.

image::docs/images/GA4_example.png[Google Analytics 4 Example]

== External dependencies

The library does not have any transitive dependencies and depends directly only on `org.jetbrains:annotations`.

== JSON compliance

The library supports basic JSON functionality. Escaping works for the most common characters used in the English language. To keep the dependency graph simple, we did not depend on any external JSON library.

== Thread usage

The library is using a single thread named `"analytics-http-client"` to send requests. This thread is initially started on demand and will remain dormant throughout the lifespan of the JVM.



